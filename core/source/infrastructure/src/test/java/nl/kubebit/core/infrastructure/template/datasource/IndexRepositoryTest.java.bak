package nl.kubebit.core.infrastructure.template.datasource;

import static org.junit.jupiter.api.Assertions.assertNotNull;

import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;

import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;

/**
 * 
 */
@Disabled
@SpringBootTest
public class IndexRepositoryTest {

    //
    @Autowired
    private IndexRepository repository;

    /**
     * @throws IOException 
     * @throws URISyntaxException 
     * 
     */
    @Test
    void pullIndex_when_then() throws URISyntaxException, IOException {

        // given
        var repo = "https://charts.bitnami.com/bitnami";

        // when
        var indexFile = repository.pullIndex(repo);

        // then
        assertNotNull(indexFile);
    }

    /**
     * @throws URISyntaxException 
     * @throws IOException 
     * 
     */
    @Test
    void pullChart_when_then() throws URISyntaxException, IOException {

        // given
        var chart = new URI("https://charts.bitnami.com/bitnami/wordpress-23.1.0.tgz");

        // when
        var chartFile = repository.pullChart(chart);

        // then
        assertNotNull(chartFile);
    }

}
